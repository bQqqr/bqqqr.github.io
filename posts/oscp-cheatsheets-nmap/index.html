<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta http-equiv=content-security-policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self'; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/; script-src 'self' 'unsafe-inline' https://www.google-analytics.com https://cdn.jsdelivr.net/; prefetch-src 'self'; connect-src 'self' https://www.google-analytics.com;"><meta name=author content="Christos Kaltsas"><meta name=description content="An attempt to deconstruct nmap's complex usage."><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="OSCP Cheatsheets - Nmap"><meta name=twitter:description content="An attempt to deconstruct nmap's complex usage."><meta property="og:title" content="OSCP Cheatsheets - Nmap"><meta property="og:description" content="An attempt to deconstruct nmap's complex usage."><meta property="og:type" content="article"><meta property="og:url" content="https://www.christoskaltsas.com/posts/oscp-cheatsheets-nmap/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-06-08T00:00:00+00:00"><meta property="article:modified_time" content="2022-06-08T00:00:00+00:00"><title>Christos Kaltsas's Webpage</title><link rel=canonical href=https://www.christoskaltsas.com/posts/oscp-cheatsheets-nmap/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.d060421287b14287ee4ccfd0f5025c7db0ac9e336939250345d910b3092eb51e.css integrity="sha256-0GBCEoexQofuTM/Q9QJcfbCsnjNpOSUDRdkQswkutR4=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.966ca17cd987e597a76b24d5dc9575a0720d7dd08d87c6bdc05f2ff000fb29dc.css integrity="sha256-lmyhfNmH5ZenayTV3JV1oHINfdCNh8a9wF8v8AD7Kdw=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicon.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5><meta name=generator content="Hugo 0.100.2"></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Christos Kaltsas's Webpage</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/contact/>Contact</a></li><li class=navigation-item><a class=navigation-link href=/posts/>Posts</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://www.christoskaltsas.com/posts/oscp-cheatsheets-nmap/>OSCP Cheatsheets - Nmap</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2022-06-08T00:00:00Z>June 8, 2022</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
3-minute read</span></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/cheatsheet/>cheatsheet</a></span>
<span class=separator>â€¢</span>
<span class=tag><a href=/tags/nmap/>nmap</a></span>
<span class=separator>â€¢</span>
<span class=tag><a href=/tags/enumeration/>enumeration</a></span>
<span class=separator>â€¢</span>
<span class=tag><a href=/tags/oscp/>oscp</a></span></div></div></header><div><ul><li><a href=#-nmap>ğŸ•µï¸ Nmap</a><ul><li><a href=#-target-specification>ğŸ¯ Target Specification</a></li><li><a href=#-scan-techniques>ğŸ§° Scan Techniques</a></li><li><a href=#-port-specificaton>ğŸšª Port Specificaton</a></li><li><a href=#-version-detection>ğŸ” Version Detection</a></li><li><a href=#-os-detection>ğŸ” OS Detection</a></li><li><a href=#-timing-and-perfomance>â° Timing and Perfomance</a></li><li><a href=#-nse-scripts>ğŸ¤– NSE Scripts</a></li><li><a href=#-output>ğŸ“ Output</a></li><li><a href=#-useful-combinations>ğŸ’¡ Useful Combinations</a></li></ul></li></ul><h1 id=-nmap>ï¸ğŸ•µï¸ Nmap
<a class=heading-link href=#-nmap><i class="fa fa-link" aria-hidden=true></i></a></h1><p>Nmap was designed to rapidly scan large networks, but works fine against single hosts.</p><div class="notice warning"><div class=notice-title><i class="fa fa-exclamation-triangle" aria-hidden=true></i>Warning</div><div class=notice-content>Invoking network scan techniques on systems, hosts or network ranges other than those under the own responsibility is illegal in quite a few jurisdictions.</div></div><p><img src=/img/nmap.gif#center alt="NMAP Cat Meme"></p><h2 id=-target-specification>ğŸ¯ Target Specification
<a class=heading-link href=#-target-specification><i class="fa fa-link" aria-hidden=true></i></a></h2><p>Firstly, you must choose your targets.</p><ul><li><p>Scan a single ipv4 address.<br><code>nmap 192.168.1.1</code></p></li><li><p>Scan multiple ipv4 addresses.<br><code>nmap 192.168.1.1 192.168.1.2</code></p></li><li><p>Scan a range of ipv4 addresses.<br><code>nmap 192.168.1.1-254</code></p></li><li><p>Scan a domain name.<br><code>nmap scanme.nmap.org</code></p></li><li><p>Scan using the CIDR notation.<br><code>nmap 192.168.1.0/24</code></p></li><li><p>Scan using an input file.<br><code>nmap -iL targets.txt</code></p></li></ul><h2 id=-scan-techniques>ğŸ§° Scan Techniques
<a class=heading-link href=#-scan-techniques><i class="fa fa-link" aria-hidden=true></i></a></h2><p>Secondly, you must select how nmap scans the targets.</p><div class="notice tip"><div class=notice-title><i class="fa fa-lightbulb-o" aria-hidden=true></i>Tip</div><div class=notice-content>Always scan with SYN and UDP unless you have not root access.</div></div><ul><li><p>Scan using SYN technique.<br><code>sudo nmap 192.168.1.1 -sS</code></p></li><li><p>Scan using TCP techique.<br><code>sudo nmap 192.168.1.1 -sT</code></p></li><li><p>Scan using UDP technique.<br><code>sudo nmap 192.168.1.1 -sU</code></p></li></ul><h2 id=-port-specificaton>ğŸšª Port Specificaton
<a class=heading-link href=#-port-specificaton><i class="fa fa-link" aria-hidden=true></i></a></h2><p>Now, you must specify the ports, that nmap will scan.</p><ul><li><p>Scan a single port.<br><code>nmap 192.168.1.1 -p 80</code></p></li><li><p>Scan a range of ports.<br><code>nmap 192.168.1.1 -p 1-1000</code></p></li><li><p>Scan all ports.<br><code>nmap 192.168.1.1 -p-</code></p></li><li><p>Scan the top used ports.<br><code>nmap 192.168.1.1 --top-ports 100</code></p></li><li><p>Scan multiple UDP and TCP ports.<br><code>nmap 192.168.1.1 -p U:53, T:21-25,80</code></p></li></ul><h2 id=-version-detection>ğŸ” Version Detection
<a class=heading-link href=#-version-detection><i class="fa fa-link" aria-hidden=true></i></a></h2><p>Afterwards, you must specify how nmap detects a service&rsquo;s version.</p><ul><li><p>Let nmap determine the version.<br><code>nmap 192.168.1.1 -sV</code></p></li><li><p>Enable intensity level 9. Most likely correct. Slow.<br><code>nmap 192.168.1.1 -sV --version-all</code></p></li></ul><h2 id=-os-detection>ğŸ” OS Detection
<a class=heading-link href=#-os-detection><i class="fa fa-link" aria-hidden=true></i></a></h2><p>You might also want to detect the target&rsquo;s Operating System.</p><ul><li><p>Remote OS detection using TCP/IP stack fingerprinting. Let nmap guess aggresively.<br><code>nmap 192.168.1.1 -O --osscan-guess</code></p></li><li><p>Enable OS detection, version detection, script scanning and traceroute.<br><code>nmap 192.168.1.1 -A</code></p></li></ul><h2 id=-timing-and-perfomance>â° Timing and Perfomance
<a class=heading-link href=#-timing-and-perfomance><i class="fa fa-link" aria-hidden=true></i></a></h2><p>Depending on your network bandwidth, you may optimize nmap accordingly.</p><ul><li><code>nmap 192.168.1.1 -T0</code> <em>Paranoid</em></li><li><code>nmap 192.168.1.1 -T1</code> <em>Sneaky</em></li><li><code>nmap 192.168.1.1 -T2</code> <em>Polite</em></li><li><code>nmap 192.168.1.1 -T3</code> <em>Normal</em></li><li><code>nmap 192.168.1.1 -T4</code> <em>Aggressive</em></li><li><code>nmap 192.168.1.1 -T5</code> <em>Insane</em></li></ul><h2 id=-nse-scripts>ğŸ¤– NSE Scripts
<a class=heading-link href=#-nse-scripts><i class="fa fa-link" aria-hidden=true></i></a></h2><p>Automate a variety of networking tasks using NSE lua scripts.</p><ul><li><p>Scan with default NSE scripts. Considered useful for discovery and safe.<br><code>nmap 192.168.1.1 -sC</code><br><code>nmap 192.168.1.1 --script default</code></p></li><li><p>Scan with a specific script.<br><code>nmap 192.168.1.1 --script banner</code></p></li><li><p>Scan with multiple scripts using a wildcard.<br><code>nmap 192.168.1.1 --script=http*</code></p></li></ul><h2 id=-output>ğŸ“ Output
<a class=heading-link href=#-output><i class="fa fa-link" aria-hidden=true></i></a></h2><p>It&rsquo;s is really important to select carefully the nmap&rsquo;s output options.</p><ul><li><p>Save normal output to a file.<br><code>nmap 192.168.1.1 -oN normal.txt</code></p></li><li><p>Save xml output to a file.<br><code>nmap 192.168.1.1 -oX xml.txt</code></p></li><li><p>Save grepable output to a file.<br><code>nmap 192.168.1.1 -oG grep.txt</code></p></li><li><p>Save all output formats at once.<br><code>nmap 192.168.1.1 -oA nmap_results</code></p></li></ul><h2 id=-useful-combinations>ğŸ’¡ Useful Combinations
<a class=heading-link href=#-useful-combinations><i class="fa fa-link" aria-hidden=true></i></a></h2><ul><li><p>Using nmap to perform a complete first scan to a known target.<br><code>sudo nmap -Pn -sS -sC -sV -p- -oA nmap_results 192.168.1.1</code></p></li><li><p>Using nmap to perform a combined UDP and SYN scan to a known target.<br><code>sudo nmap -Pn -sS -sU 192.168.1.1</code></p></li><li><p>Using nmap to perform a network sweep and enumerate live hosts.<br><code>nmap -sn 192.168.1.1-255 -oG grepable.txt</code></p></li></ul></div><footer></footer></article></section></div><footer class=footer><section class=container>Â©
2022
Christos Kaltsas
Â·
Licensed under <a rel=license href=http://creativecommons.org/licenses/by-nd/4.0/>CC BY-ND 4.0</a></section></footer></main><script src=/js/coder.min.f411a1043e37c7c14dfb03f4d94d60d9ee69cfa413b16d0fd4f28695babb82bb.js integrity="sha256-9BGhBD43x8FN+wP02U1g2e5pz6QTsW0P1PKGlbq7grs="></script></body></html>